<html>
	<head>
		<script src="https://cdn.firebase.com/js/client/1.0.6/firebase.js"></script>
		<script src="https://cdn.firebase.com/js/simple-login/1.2.5/firebase-simple-login.js"></script>
		<script>
			var firebase = new Firebase("https://trump.firebaseio.com/");
			var app_user;
            var auth = new FirebaseSimpleLogin(firebase, function (error, user) {
              if (error) {
                // an error occurred while attempting login
                alert(error);
              } else if (user) {
                // user authenticated with Firebase
                alert('User ID: ' + user.id + ', Provider: ' + user.provider);
                app_user = user;
              } else {
                // user is logged out
              }
            });
            
            /* FIRE EVENTS */
            firebase.on('value', function (gamedata) {
                Ti.App.fireEvent('app:gameListChanged', { games: gamedata.val().games });
            });
            
            
            /* LISTEN FOR EVENTS */
            Ti.App.addEventListener('app:fbAuthed', function (e) {
                auth.login('facebook', {
                    access_token: e.access_token
                });
            });
            
            Ti.App.addEventListener('app:createGame', function (event) {
				var adjective_list = new Firebase('https://trump.firebaseio.com/adjective_list/');
				adjective_list.on('value', function (adjectives) {
					adjectives = adjectives.val();
					selection = adjectives[randInt(0, adjectives.length)];
					Ti.API.info(selection['adjective'] + ': ' + selection['synonyms'].join(', '));
				});
				
				var user = new Firebase('https://trump.firebaseio.com/users/' + app_user.id); 
            });
            
            /* UTILITIES */
			function randInt(min, max) {
				return Math.floor(Math.random() * (max - min + 1) + min);
			}
			
			Ti.App.fireEvent('app:webviewproxyDidLoad');
		</script>
	</head>
	<body></body>
</html>